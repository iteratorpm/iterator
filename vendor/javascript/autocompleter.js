// autocompleter@9.3.2 downloaded from https://ga.jspm.io/npm:autocompleter@9.3.2/autocomplete.es.js

function autocomplete(e){var t=document;var n=e.container||t.createElement("div");var r=e.preventSubmit||0;n.id=n.id||"autocomplete-"+uid();var a=n.style;var i=e.debounceWaitMs||0;var o=e.disableAutoSelect||false;var c=n.parentElement;var l=[];var s="";var u=2;var d=e.showOnFocus;var v;var f=0;var p;var m=false;var g=false;e.minLength!==void 0&&(u=e.minLength);if(!e.input)throw new Error("input undefined");var E=e.input;n.className=[n.className,"autocomplete",e.className||""].join(" ").trim();n.setAttribute("role","listbox");E.setAttribute("role","combobox");E.setAttribute("aria-expanded","false");E.setAttribute("aria-autocomplete","list");E.setAttribute("aria-controls",n.id);E.setAttribute("aria-owns",n.id);E.setAttribute("aria-activedescendant","");E.setAttribute("aria-haspopup","listbox");a.position="absolute";function uid(){return Date.now().toString(36)+Math.random().toString(36).substring(2)}function detach(){var e=n.parentNode;e&&e.removeChild(n)}function clearDebounceTimer(){p&&window.clearTimeout(p)}function attach(){n.parentNode||(c||t.body).appendChild(n)}function containerDisplayed(){return!!n.parentNode}function clear(){f++;l=[];s="";v=void 0;E.setAttribute("aria-activedescendant","");E.setAttribute("aria-expanded","false");detach()}function updatePosition(){if(containerDisplayed()){E.setAttribute("aria-expanded","true");a.height="auto";a.width=E.offsetWidth+"px";var r=0;var i;calc();calc();e.customize&&i&&e.customize(E,i,n,r)}function calc(){var e=t.documentElement;var n=e.clientTop||t.body.clientTop||0;var o=e.clientLeft||t.body.clientLeft||0;var c=window.pageYOffset||e.scrollTop;var l=window.pageXOffset||e.scrollLeft;i=E.getBoundingClientRect();var s=i.top+E.offsetHeight+c-n;var u=i.left+l-o;a.top=s+"px";a.left=u+"px";r=window.innerHeight-(i.top+E.offsetHeight);r<0&&(r=0);a.top=s+"px";a.bottom="";a.left=u+"px";a.maxHeight=r+"px"}}function update(){n.textContent="";E.setAttribute("aria-activedescendant","");var render=function(e,n,r){var a=t.createElement("div");a.textContent=e.label||"";return a};e.render&&(render=e.render);var renderGroup=function(e,n){var r=t.createElement("div");r.textContent=e;return r};e.renderGroup&&(renderGroup=e.renderGroup);var r=t.createDocumentFragment();var a=uid();l.forEach((function(t,i){if(t.group&&t.group!==a){a=t.group;var o=renderGroup(t.group,s);if(o){o.className+=" group";r.appendChild(o)}}var c=render(t,s,i);if(c){c.id=n.id+"_"+i;c.setAttribute("role","option");c.addEventListener("click",(function(n){g=true;try{e.onSelect(t,E)}finally{g=false}clear();n.preventDefault();n.stopPropagation()}));if(t===v){c.className+=" selected";c.setAttribute("aria-selected","true");E.setAttribute("aria-activedescendant",c.id)}r.appendChild(c)}}));n.appendChild(r);if(l.length<1){if(!e.emptyMsg){clear();return}var i=t.createElement("div");i.id=n.id+"_"+uid();i.className="empty";i.textContent=e.emptyMsg;n.appendChild(i);E.setAttribute("aria-activedescendant",i.id)}attach();updatePosition();updateScroll()}function updateIfDisplayed(){containerDisplayed()&&update()}function resizeEventHandler(){updateIfDisplayed()}function scrollEventHandler(e){e.target!==n?updateIfDisplayed():e.preventDefault()}function inputEventHandler(){g||fetch(0)}function updateScroll(){var e=n.getElementsByClassName("selected");if(e.length>0){var t=e[0];var r=t.previousElementSibling;r&&r.className.indexOf("group")!==-1&&!r.previousElementSibling&&(t=r);if(t.offsetTop<n.scrollTop)n.scrollTop=t.offsetTop;else{var a=t.offsetTop+t.offsetHeight;var i=n.scrollTop+n.offsetHeight;a>i&&(n.scrollTop+=a-i)}}}function selectPreviousSuggestion(){var e=l.indexOf(v);v=e===-1?void 0:l[(e+l.length-1)%l.length];updateSelectedSuggestion(e)}function selectNextSuggestion(){var e=l.indexOf(v);v=l.length<1?void 0:e===-1?l[0]:l[(e+1)%l.length];updateSelectedSuggestion(e)}function updateSelectedSuggestion(e){if(l.length>0){unselectSuggestion(e);selectSuggestion(l.indexOf(v));updateScroll()}}function selectSuggestion(e){var r=t.getElementById(n.id+"_"+e);if(r){r.classList.add("selected");r.setAttribute("aria-selected","true");E.setAttribute("aria-activedescendant",r.id)}}function unselectSuggestion(e){var r=t.getElementById(n.id+"_"+e);if(r){r.classList.remove("selected");r.removeAttribute("aria-selected");E.removeAttribute("aria-activedescendant")}}function handleArrowAndEscapeKeys(e,t){var n=containerDisplayed();if(t==="Escape")clear();else{if(!n||l.length<1)return;t==="ArrowUp"?selectPreviousSuggestion():selectNextSuggestion()}e.preventDefault();n&&e.stopPropagation()}function handleEnterKey(t){if(v){r===2&&t.preventDefault();g=true;try{e.onSelect(v,E)}finally{g=false}clear()}r===1&&t.preventDefault()}function keydownEventHandler(e){var t=e.key;switch(t){case"ArrowUp":case"ArrowDown":case"Escape":handleArrowAndEscapeKeys(e,t);break;case"Enter":handleEnterKey(e);break}}function focusEventHandler(){d&&fetch(1)}function fetch(e){if(E.value.length>=u||e===1){clearDebounceTimer();p=window.setTimeout((function(){return startFetch(E.value,e,E.selectionStart||0)}),e===0||e===2?i:0)}else clear()}function startFetch(t,n,r){if(!m){var a=++f;e.fetch(t,(function(e){if(f===a&&e){l=e;s=t;v=l.length<1||o?void 0:l[0];update()}}),n,r)}}function keyupEventHandler(t){e.keyup?e.keyup({event:t,fetch:function(){return fetch(0)}}):containerDisplayed()||t.key!=="ArrowDown"||fetch(0)}function clickEventHandler(t){e.click&&e.click({event:t,fetch:function(){return fetch(2)}})}function blurEventHandler(){setTimeout((function(){t.activeElement!==E&&clear()}),200)}function manualFetch(){startFetch(E.value,3,E.selectionStart||0)}n.addEventListener("mousedown",(function(e){e.stopPropagation();e.preventDefault()}));n.addEventListener("focus",(function(){return E.focus()}));detach();function destroy(){E.removeEventListener("focus",focusEventHandler);E.removeEventListener("keyup",keyupEventHandler);E.removeEventListener("click",clickEventHandler);E.removeEventListener("keydown",keydownEventHandler);E.removeEventListener("input",inputEventHandler);E.removeEventListener("blur",blurEventHandler);window.removeEventListener("resize",resizeEventHandler);t.removeEventListener("scroll",scrollEventHandler,true);E.removeAttribute("role");E.removeAttribute("aria-expanded");E.removeAttribute("aria-autocomplete");E.removeAttribute("aria-controls");E.removeAttribute("aria-activedescendant");E.removeAttribute("aria-owns");E.removeAttribute("aria-haspopup");clearDebounceTimer();clear();m=true}E.addEventListener("keyup",keyupEventHandler);E.addEventListener("click",clickEventHandler);E.addEventListener("keydown",keydownEventHandler);E.addEventListener("input",inputEventHandler);E.addEventListener("blur",blurEventHandler);E.addEventListener("focus",focusEventHandler);window.addEventListener("resize",resizeEventHandler);t.addEventListener("scroll",scrollEventHandler,true);return{destroy:destroy,fetch:manualFetch}}export{autocomplete as default};

