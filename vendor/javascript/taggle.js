// taggle@1.15.0 downloaded from https://ga.jspm.io/npm:taggle@1.15.0/src/taggle.js

var t="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;var e={};
/* !
 * @author Sean Coker <hello@sean.is>
 * @version 1.15.0
 * @url http://sean.is/poppin/tags
 * @license MIT
 * @description Taggle is a dependency-less tagging library
 */(function(t,s){var i="Taggle";e?e=t[i]=s():t[i]=s()})(e,(function(){var noop=function(){};var retTrue=function(){return true};var e=8;var s=46;var i=188;var n=9;var a=13;var r=37;var o=39;var l={additionalTagClasses:"",allowDuplicates:false,saveOnBlur:false,clearOnBlur:true,duplicateTagClass:"",containerFocusClass:"active",focusInputOnContainerClick:true,hiddenInputName:"taggles[]",tags:[],delimeter:",",delimiter:"",attachTagId:false,allowedTags:[],disallowedTags:[],trimTags:true,maxTags:null,tabIndex:1,placeholder:"Enter tags...",submitKeys:[i,n,a],preserveCase:false,inputFormatter:noop,tagFormatter:noop,onBeforeTagAdd:noop,onTagAdd:noop,onBeforeTagRemove:retTrue,onTagRemove:noop};function _extend(){var t=arguments[0];for(var e=1,s=arguments.length;e<s;e++){var i=arguments[e];for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])}return t}function _isArray(t){return Array.isArray?Array.isArray(t):"[object Array]"===Object.prototype.toString.call(t)}function _on(t,e,s){t.addEventListener?t.addEventListener(e,s,false):t.attachEvent?t.attachEvent("on"+e,s):t["on"+e]=s}function _off(t,e,s){t.removeEventListener?t.removeEventListener(e,s,false):t.detachEvent?t.detachEvent("on"+e,s):t["on"+e]=null}function _trim(t){return t.replace(/^\s+|\s+$/g,"")}function _setText(t,e){window.attachEvent&&!window.addEventListener?t.innerText=e:t.textContent=e}function _clamp(t,e,s){return Math.min(Math.max(t,e),s)}var Taggle=function(e,s){(this||t).settings=_extend({},l,s);(this||t).measurements={container:{rect:null,style:null,padding:null}};(this||t).container=e;(this||t).tag={values:[],elements:[]};(this||t).list=document.createElement("ul");(this||t).inputLi=document.createElement("li");(this||t).input=document.createElement("input");(this||t).sizer=document.createElement("div");(this||t).pasting=false;(this||t).placeholder=null;(this||t).data=null;(this||t).settings.placeholder&&((this||t).placeholder=document.createElement("span"));"string"===typeof e&&((this||t).container=document.getElementById(e));(this||t)._id=0;(this||t)._backspacePressed=false;(this||t)._inputPosition=0;(this||t)._closeEvents=[];(this||t)._closeButtons=[];this._setMeasurements();this._setupTextarea();this._attachEvents()};Taggle.prototype._setMeasurements=function(){(this||t).measurements.container.rect=(this||t).container.getBoundingClientRect();(this||t).measurements.container.style=window.getComputedStyle((this||t).container);var e=(this||t).measurements.container.style;var s=parseInt(e["padding-left"]||e.paddingLeft,10);var i=parseInt(e["padding-right"]||e.paddingRight,10);var n=parseInt(e["border-left-width"]||e.borderLeftWidth,10);var a=parseInt(e["border-right-width"]||e.borderRightWidth,10);(this||t).measurements.container.padding=s+i+n+a};Taggle.prototype._setupTextarea=function(){var e;(this||t).list.className="taggle_list";(this||t).input.type="text";(this||t).input.style.paddingLeft=0;(this||t).input.style.paddingRight=0;(this||t).input.className="taggle_input";(this||t).input.tabIndex=(this||t).settings.tabIndex;(this||t).sizer.className="taggle_sizer";if((this||t).settings.tags.length)for(var s=0,i=(this||t).settings.tags.length;s<i;s++){var n=this._createTag((this||t).settings.tags[s],(this||t).tag.values.length);(this||t).list.appendChild(n)}if((this||t).placeholder){this._hidePlaceholder();(this||t).placeholder.classList.add("taggle_placeholder");(this||t).container.appendChild((this||t).placeholder);_setText((this||t).placeholder,(this||t).settings.placeholder);(this||t).settings.tags.length||this._showPlaceholder()}var a=(this||t).settings.inputFormatter((this||t).input);a&&((this||t).input=a);(this||t).inputLi.appendChild((this||t).input);(this||t).list.appendChild((this||t).inputLi);(this||t).container.appendChild((this||t).list);(this||t).container.appendChild((this||t).sizer);e=window.getComputedStyle((this||t).input).fontSize;(this||t).sizer.style.fontSize=e};Taggle.prototype._attachEvents=function(){var e=this||t;if((this||t)._eventsAttached)return false;(this||t)._eventsAttached=true;function containerClick(){e.input.focus()}if((this||t).settings.focusInputOnContainerClick){(this||t)._handleContainerClick=containerClick.bind(this||t);_on((this||t).container,"click",(this||t)._handleContainerClick)}(this||t)._handleFocus=(this||t)._setFocusStateForContainer.bind(this||t);(this||t)._handleBlur=(this||t)._blurEvent.bind(this||t);(this||t)._handleKeydown=(this||t)._keydownEvents.bind(this||t);(this||t)._handleKeyup=(this||t)._keyupEvents.bind(this||t);_on((this||t).input,"focus",(this||t)._handleFocus);_on((this||t).input,"blur",(this||t)._handleBlur);_on((this||t).input,"keydown",(this||t)._handleKeydown);_on((this||t).input,"keyup",(this||t)._handleKeyup);return true};Taggle.prototype._detachEvents=function(){if(!(this||t)._eventsAttached)return false;var e=this||t;(this||t)._eventsAttached=false;_off((this||t).container,"click",(this||t)._handleContainerClick);_off((this||t).input,"focus",(this||t)._handleFocus);_off((this||t).input,"blur",(this||t)._handleBlur);_off((this||t).input,"keydown",(this||t)._handleKeydown);_off((this||t).input,"keyup",(this||t)._handleKeyup);(this||t)._closeButtons.forEach((function(t,s){var i=e._closeEvents[s];_off(t,"click",i)}));return true};Taggle.prototype._fixInputWidth=function(){this._setMeasurements();this._setInputWidth()};Taggle.prototype._canAdd=function(e,s){if(!s)return false;var i=(this||t).settings.maxTags;if(null!==i&&i<=this.getTagValues().length)return false;if(false===(this||t).settings.onBeforeTagAdd(e,s))return false;if(!(this||t).settings.allowDuplicates&&this._hasDupes(s))return false;var n=(this||t).settings.preserveCase;var a=(this||t).settings.allowedTags;if(a.length&&!this._tagIsInArray(s,a,n))return false;var r=(this||t).settings.disallowedTags;return!r.length||!this._tagIsInArray(s,r,n)};Taggle.prototype._tagIsInArray=function(t,e,s){if(s)return-1!==e.indexOf(t);var i=[].slice.apply(e).map((function(t){return t.toLowerCase()}));return-1!==i.indexOf(t)};Taggle.prototype._add=function(e,s,i){var n=this||t;var a=s||"";var r=(this||t).settings.delimiter||(this||t).settings.delimeter;if("string"!==typeof s){a=(this||t).input.value;if((this||t).settings.trimTags){a[0]===r&&(a=a.replace(r,""));a=_trim(a)}}a.split(r).map((function(t){n.settings.trimTags&&(t=_trim(t));return n._formatTag(t)})).forEach((function(t){if(n._canAdd(e,t)){var s=n.tag.values.length;var a=_clamp(i||s,0,s);var r=n._createTag(t,a);var o=n.list.children;var l=o[a];n.list.insertBefore(r,l);t=n.tag.values[a];n.settings.onTagAdd(e,t);n.input.value="";n._fixInputWidth();n._setFocusStateForContainer()}}))};Taggle.prototype._checkPrevOrNextTag=function(i){i=i||window.event;var n=(this||t).container.querySelectorAll(".taggle");var a=_clamp((this||t)._inputPosition-1,0,n.length-1);var r=_clamp((this||t)._inputPosition,0,n.length-1);var o=a;i.keyCode===s&&(o=r);var l=n[o];var h="taggle_hot";var u=-1!==[e,s].indexOf(i.keyCode);if(""===(this||t).input.value&&u&&!(this||t)._backspacePressed)if(l.classList.contains(h)){(this||t)._backspacePressed=true;this._remove(l,i);this._fixInputWidth();this._setFocusStateForContainer()}else l.classList.add(h);else l.classList.contains(h)&&l.classList.remove(h)};Taggle.prototype._setInputWidth=function(){var e=(this||t).sizer.getBoundingClientRect().width;var s=(this||t).measurements.container.rect.width-(this||t).measurements.container.padding;var i=parseInt((this||t).sizer.style.fontSize,10);var n=Math.round(_clamp(e+1.5*i,10,s));(this||t).input.style.width=n+"px"};Taggle.prototype._hasDupes=function(e){var s=(this||t).tag.values.indexOf(e);var i=(this||t).container.querySelector(".taggle_list");var n;if((this||t).settings.duplicateTagClass){n=i.querySelectorAll("."+(this||t).settings.duplicateTagClass);for(var a=0,r=n.length;a<r;a++)n[a].classList.remove((this||t).settings.duplicateTagClass)}if(s>-1){(this||t).settings.duplicateTagClass&&i.childNodes[s].classList.add((this||t).settings.duplicateTagClass);return true}return false};Taggle.prototype._isConfirmKey=function(e){var s=false;(this||t).settings.submitKeys.indexOf(e)>-1&&(s=true);return s};Taggle.prototype._setFocusStateForContainer=function(){this._fixInputWidth();(this||t).container.classList.contains((this||t).settings.containerFocusClass)||(this||t).container.classList.add((this||t).settings.containerFocusClass);this._hidePlaceholder()};Taggle.prototype._blurEvent=function(e){(this||t).container.classList.contains((this||t).settings.containerFocusClass)&&(this||t).container.classList.remove((this||t).settings.containerFocusClass);if((this||t).settings.saveOnBlur){e=e||window.event;this._setInputWidth();if(""!==(this||t).input.value){this._confirmValidTagEvent(e);return}(this||t).tag.values.length&&this._checkPrevOrNextTag(e)}else if((this||t).settings.clearOnBlur){(this||t).input.value="";this._setInputWidth()}(this||t).tag.values.length||(this||t).input.value||this._showPlaceholder()};Taggle.prototype._keydownEvents=function(e){e=e||window.event;var s=e.keyCode;(this||t).pasting=false;this._setInputWidth();86===s&&e.metaKey&&((this||t).pasting=true);this._isConfirmKey(s)&&""!==(this||t).input.value?this._confirmValidTagEvent(e):(this||t).tag.values.length&&this._checkPrevOrNextTag(e)};Taggle.prototype._keyupEvents=function(e){e=e||window.event;(this||t)._backspacePressed=false;if(-1===[r,o].indexOf(e.keyCode)){_setText((this||t).sizer,(this||t).input.value);(this||t).input.value||this._setInputWidth();if((this||t).pasting&&""!==(this||t).input.value){this._add(e);(this||t).pasting=false}}else this._moveInput(e.keyCode)};Taggle.prototype._moveInput=function(e){var s=(this||t)._inputPosition;switch(e){case r:var i=_clamp((this||t)._inputPosition-1,0,(this||t).tag.values.length);var n=s!==i;(this||t)._inputPosition=i;if(n){(this||t).list.insertBefore((this||t).inputLi,(this||t).list.childNodes[i]||null);(this||t).input.focus()}break;case o:var a=_clamp((this||t)._inputPosition+1,0,(this||t).tag.values.length);var l=s!==a;(this||t)._inputPosition=a;if(l){(this||t).list.insertBefore((this||t).inputLi,(this||t).list.childNodes[a+1]||null);(this||t).input.focus()}break;default:break}};Taggle.prototype._confirmValidTagEvent=function(e){e=e||window.event;e.preventDefault?e.preventDefault():e.returnValue=false;this._add(e,null,(this||t)._inputPosition)};Taggle.prototype._createTag=function(e,s){var i=document.createElement("li");var n=document.createElement("button");var a=document.createElement("input");var r=document.createElement("span");e=this._formatTag(e);_setText(n,"×");n.className="close";n.setAttribute("type","button");var o=(this||t)._remove.bind(this||t,n);_on(n,"click",o);_setText(r,e);r.className="taggle_text";i.className="taggle "+(this||t).settings.additionalTagClasses;a.type="hidden";a.value=e;a.name=(this||t).settings.hiddenInputName;i.appendChild(r);i.appendChild(n);i.appendChild(a);var l=(this||t).settings.tagFormatter(i);"undefined"!==typeof l&&(i=l);if(!(i instanceof HTMLElement)||!("li"===i.localName||"LI"===i.tagName))throw new Error("tagFormatter must return an li element");if((this||t).settings.attachTagId){(this||t)._id+=1;e={text:e,id:(this||t)._id}}(this||t).tag.values.splice(s,0,e);(this||t).tag.elements.splice(s,0,i);(this||t)._closeEvents.splice(s,0,o);(this||t)._closeButtons.splice(s,0,n);(this||t)._inputPosition=_clamp((this||t)._inputPosition+1,0,(this||t).tag.values.length);return i};Taggle.prototype._showPlaceholder=function(){if((this||t).placeholder){(this||t).placeholder.style.opacity=1;(this||t).placeholder.setAttribute("aria-hidden","false")}};Taggle.prototype._hidePlaceholder=function(){if((this||t).placeholder){(this||t).placeholder.style.opacity=0;(this||t).placeholder.setAttribute("aria-hidden","true")}};Taggle.prototype._remove=function(e,s){var i=this||t;var n;var a;var r;"li"!==e.tagName.toLowerCase()&&(e=e.parentNode);a="a"===e.tagName.toLowerCase()?e.parentNode:e;r=(this||t).tag.elements.indexOf(a);n=(this||t).tag.values[r];function done(t){if(!t){var a=i._closeEvents[r];var o=i._closeButtons[r];_off(o,"click",a);e.parentNode.removeChild(e);i.tag.elements.splice(r,1);i.tag.values.splice(r,1);i._closeEvents.splice(r,1);i._closeButtons.splice(r,1);i.settings.onTagRemove(s,n);r<i._inputPosition&&(i._inputPosition=_clamp(i._inputPosition-1,0,i.tag.values.length));i._setFocusStateForContainer()}}var o=(this||t).settings.onBeforeTagRemove(s,n,done);o&&done()};Taggle.prototype._formatTag=function(e){return(this||t).settings.preserveCase?e:e.toLowerCase()};Taggle.prototype._isIndexInRange=function(e){return e>=0&&e<=(this||t).tag.values.length-1};Taggle.prototype.getTags=function(){return{elements:this.getTagElements(),values:this.getTagValues()}};Taggle.prototype.getTagElements=function(){return[].slice.apply((this||t).tag.elements)};Taggle.prototype.getTagValues=function(){return[].slice.apply((this||t).tag.values)};Taggle.prototype.getInput=function(){return(this||t).input};Taggle.prototype.getContainer=function(){return(this||t).container};Taggle.prototype.add=function(e,s){var i=_isArray(e);if(i){var n=s;for(var a=0,r=e.length;a<r;a++)if("string"===typeof e[a]){this._add(null,e[a],n);isNaN(n)||(n+=1)}}else this._add(null,e,s);return this||t};Taggle.prototype.edit=function(e,s){if("string"!==typeof e)throw new Error("First edit argument must be of type string");if("number"!==typeof s)throw new Error("Second edit argument must be a number");if(!this._isIndexInRange(s))throw new Error("Edit index should be between 0 and "+(this||t).tag.values.length-1);var i=(this||t).tag.values[s];"string"===typeof i?(this||t).tag.values[s]=e:(this||t).tag.values[s].text=e;_setText((this||t).tag.elements[s],e);return this||t};Taggle.prototype.move=function(e,s){if("number"!==typeof e||"number"!==typeof s)throw new Error("Both arguments must be numbers");if(!this._isIndexInRange(e))throw new Error("First index should be between 0 and "+(this||t).tag.values.length-1);if(!this._isIndexInRange(s))throw new Error("Second index should be between 0 and "+(this||t).tag.values.length-1);if(e===s)return this||t;var i=(this||t).tag.values[e];var n=(this||t).tag.elements[e];var a=(this||t).tag.elements[s];var r=(this||t)._closeEvents[e];var o=(this||t)._closeButtons[e];(this||t).tag.values.splice(e,1);(this||t).tag.elements.splice(e,1);(this||t)._closeEvents.splice(e,1);(this||t)._closeButtons.splice(e,1);(this||t).tag.values.splice(s,0,i);(this||t).tag.elements.splice(s,0,n);(this||t)._closeEvents.splice(e,0,r);(this||t)._closeButtons.splice(e,0,o);(this||t).list.insertBefore(n,a.nextSibling);return this||t};Taggle.prototype.remove=function(e,s){var i=(this||t).tag.values.length-1;var n=false;while(i>-1){var a=(this||t).tag.values[i];(this||t).settings.attachTagId&&(a=a.text);if(a===e){n=true;this._remove((this||t).tag.elements[i])}if(n&&!s)break;i--}return this||t};Taggle.prototype.removeAll=function(){for(var e=(this||t).tag.values.length-1;e>=0;e--)this._remove((this||t).tag.elements[e]);this._showPlaceholder();return this||t};Taggle.prototype.setOptions=function(e){(this||t).settings=_extend({},(this||t).settings,e||{});return this||t};Taggle.prototype.enable=function(){var e=[].slice.call((this||t).container.querySelectorAll("button"));var s=[].slice.call((this||t).container.querySelectorAll("input"));e.concat(s).forEach((function(t){t.removeAttribute("disabled")}));return this||t};Taggle.prototype.disable=function(){var e=[].slice.call((this||t).container.querySelectorAll("button"));var s=[].slice.call((this||t).container.querySelectorAll("input"));e.concat(s).forEach((function(t){t.setAttribute("disabled","")}));return this||t};Taggle.prototype.setData=function(e){(this||t).data=e;return this||t};Taggle.prototype.getData=function(){return(this||t).data};Taggle.prototype.attachEvents=function(){var e=this||t;var s=this._attachEvents();s&&(this||t)._closeButtons.forEach((function(t,s){var i=e._closeEvents[s];_on(t,"click",i)}));return this||t};Taggle.prototype.removeEvents=function(){this._detachEvents();return this||t};return Taggle}));var s=e;export default s;

